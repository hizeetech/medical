{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Appointment Detail</h2>
    <a href="{% url 'appointments_list' %}" class="btn btn-sm btn-outline-secondary">Back to Appointments</a>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <div class="mb-2"><strong>Patient:</strong> {{ appointment.patient.full_name }}</div>
      <div class="mb-2"><strong>Type:</strong> {{ appointment.get_appointment_type_display }}</div>
      <div class="mb-2"><strong>Scheduled:</strong> {{ appointment.scheduled_at|date:"M d, Y H:i" }}</div>
-      <div class="mb-2"><strong>Status:</strong> {{ appointment.get_status_display }}</div>
+      <div class="mb-2"><strong>Status:</strong>
+        <span class="badge-status {% if appointment.status == 'COMPLETED' %}badge-status-completed{% elif appointment.status == 'CANCELLED' %}badge-status-cancelled{% elif appointment.status == 'MISSED' %}badge-status-missed{% else %}badge-status-scheduled{% endif %}">
+          {{ appointment.get_status_display }}
+        </span>
+      </div>
      {% if appointment.notes %}
        <div class="mb-2"><strong>Notes:</strong> {{ appointment.notes }}</div>
      {% endif %}
    </div>
  </div>

  {% if can_update %}
    <div class="card">
      <div class="card-header">Update Appointment</div>
      <div class="card-body">
        <form method="post">
          {% csrf_token %}
          <div class="row g-3">
            <div class="col-md-4">
              <label class="form-label">Status</label>
              <select name="status" class="form-select">
                <option value="SCHEDULED" {% if appointment.status == 'SCHEDULED' %}selected{% endif %}>Scheduled</option>
                <option value="COMPLETED" {% if appointment.status == 'COMPLETED' %}selected{% endif %}>Completed</option>
                <option value="CANCELLED" {% if appointment.status == 'CANCELLED' %}selected{% endif %}>Cancelled</option>
                <option value="MISSED" {% if appointment.status == 'MISSED' %}selected{% endif %}>Missed</option>
              </select>
            </div>
            <div class="col-md-4">
              <label class="form-label">Reschedule Date</label>
              <input type="date" name="scheduled_date" class="form-control" value="{{ appointment.scheduled_at|date:'Y-m-d' }}">
            </div>
            <div class="col-md-4">
              <label class="form-label">Reschedule Time</label>
              <input type="time" name="scheduled_time" class="form-control" value="{{ appointment.scheduled_at|date:'H:i' }}">
            </div>
            <div class="col-12">
              <label class="form-label">Notes</label>
              <textarea name="notes" class="form-control" rows="3">{{ appointment.notes }}</textarea>
            </div>
          </div>
          <div class="mt-3">
            <button type="submit" class="btn btn-primary">Save Changes</button>
          </div>
        </form>
      </div>
    </div>
  {% else %}
    <div class="alert alert-info">You can view this appointment but cannot update it.</div>
  {% endif %}
</div>
{% endblock %}