{% extends 'base.html' %}
{% load static %}

{% block title %}Print Baby Case File{% endblock %}

{% block content %}
<div class="container my-4">
  <div class="d-flex justify-content-between align-items-center">
    <h2 class="mb-3">Baby Case File Summary</h2>
    <button class="btn btn-outline-secondary" onclick="window.print()">
      <i class="bi bi-printer"></i> Print
    </button>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <h4 class="card-title">Identity</h4>
      <p class="mb-1"><strong>Name:</strong> {{ baby.full_name }}</p>
      <p class="mb-1"><strong>Hospital ID:</strong> {{ baby.hospital_id }}</p>
      <p class="mb-1"><strong>Date of Birth:</strong> {{ baby.date_of_birth }}</p>
      {% if baby.mother %}
        <p class="mb-0"><strong>Mother:</strong> {{ baby.mother.full_name }} ({{ baby.mother.member_id }})</p>
      {% endif %}
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <h4 class="card-title">Immunization Schedule</h4>
      <table class="table table-sm">
        <thead>
          <tr>
            <th>Vaccine</th>
            <th>Scheduled</th>
            <th>Status</th>
            <th>Rescheduled</th>
          </tr>
        </thead>
        <tbody>
          {% for s in schedules %}
            <tr>
              <td>{{ s.vaccine_name }}</td>
              <td>{{ s.scheduled_date }}</td>
              <td>{{ s.status }}</td>
              <td>{% if s.rescheduled_date %}{{ s.rescheduled_date }}{% else %}-{% endif %}</td>
            </tr>
          {% empty %}
            <tr><td colspan="4" class="text-muted">No immunizations recorded.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <h4 class="card-title">Visits</h4>
      <table class="table table-sm">
        <thead>
          <tr>
            <th>Date</th>
            <th>Provider</th>
            <th>Notes</th>
          </tr>
        </thead>
        <tbody>
          {% for v in visits %}
            <tr>
              <td>{{ v.date_of_visit }}</td>
              <td>{{ v.provider }}</td>
              <td>{{ v.notes|default:"-" }}</td>
            </tr>
          {% empty %}
            <tr><td colspan="3" class="text-muted">No visits recorded.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <h4 class="card-title">Prescriptions</h4>
      <table class="table table-sm">
        <thead>
          <tr>
            <th>Drug</th>
            <th>Status</th>
            <th>Date</th>
            <th>Dosage</th>
          </tr>
        </thead>
        <tbody>
          {% for p in prescriptions %}
            <tr>
              <td>{{ p.drug_name }}</td>
              <td>{{ p.status }}</td>
              <td>{{ p.created_at }}</td>
              <td>{{ p.dosage|default:"-" }}</td>
            </tr>
          {% empty %}
            <tr><td colspan="4" class="text-muted">No prescriptions recorded.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="card mb-4">
    <div class="card-body">
      <h4 class="card-title">Lab Results</h4>
      <table class="table table-sm">
        <thead>
          <tr>
            <th>Test</th>
            <th>Status</th>
            <th>Date</th>
            <th>Summary</th>
          </tr>
        </thead>
        <tbody>
          {% for l in lab_results %}
            <tr>
              <td>{{ l.test_type }}</td>
              <td>{{ l.status }}</td>
              <td>{{ l.date_performed }}</td>
              <td>{{ l.result_summary|default:"-" }}</td>
            </tr>
          {% empty %}
            <tr><td colspan="4" class="text-muted">No lab results recorded.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="text-end">
    <a href="{% url 'baby_casefile_detail' baby.id %}" class="btn btn-link">Back to Baby Case File</a>
  </div>
</div>

<style>
@media print {
  nav, .btn, .breadcrumb, .htmx-indicator { display: none !important; }
  .card { box-shadow: none; border: 1px solid #ccc; }
}
</style>
{% endblock %}